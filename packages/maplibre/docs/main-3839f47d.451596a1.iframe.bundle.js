"use strict";(self.webpackChunk_mapcomponents_react_maplibre=self.webpackChunk_mapcomponents_react_maplibre||[]).push([[978],{33192:(t,e,n)=>{n.r(e),n.d(e,{ExampleConfig:()=>O,__namedExportsOrder:()=>j,default:()=>E});var r=n(2784),o=n(6050),a=n(76816),i=n(19698),l=n(47864),s=n(96356),u=n(62230),c=n(99146),p=n(86104),m=n(61401),d=n(77957),f=n(72642),y=n(25558),g=n(42962);function b(t){return b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},b(t)}function v(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function h(t,e,n){return(e=function(t){var e=function(t,e){if("object"!==b(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==b(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===b(e)?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function x(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,a,i,l=[],s=!0,u=!1;try{if(a=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=a.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(t){u=!0,o=t}finally{try{if(!s&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(t,e)||function(t,e){if(t){if("string"==typeof t)return S(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?S(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function S(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}const E={title:"MapComponents/MlSpatialElevationProfile",component:o.Z,argTypes:{options:{control:{type:"object"}}},decorators:c.Z};var O=function(){var t=x((0,r.useState)(),2),e=t[0],n=t[1],c=(0,i.Z)({data:e}),b=x((0,r.useState)(!1),2),v=b[0],h=b[1],S=x((0,r.useState)(!1),2),E=S[0],O=S[1],j=x((0,r.useState)([]),2),P=j[0],M=j[1],G=(0,m.Z)({mapId:"map_1"}),C=x((0,r.useState)(!0),2),D=C[0],I=C[1];return(0,r.useEffect)((function(){G.map&&60!=G.map.map.getPitch()&&G.map.map.setPitch(60)}),[G.map]),r.createElement(r.Fragment,null,r.createElement(d.Z,{open:E}),r.createElement(p.Z,{buttons:r.createElement(r.Fragment,null,r.createElement(f.Z,{variant:D?"contained":"outlined",onClick:function(){return I(!D)},sx:{marginRight:{xs:"0px",sm:"10px"}}},"Informations"),r.createElement("br",null),r.createElement("br",null),r.createElement(s.Z,{setData:n,buttonComponent:r.createElement(f.Z,{variant:"contained",sx:{marginRight:{xs:"0px",sm:"10px"}}},"Upload")}),r.createElement("br",null),r.createElement("br",null),r.createElement(f.Z,{variant:"contained",onClick:function(){h(!v)},sx:{marginRight:{xs:"0px",sm:"10px"}}},"Demo Mode"),r.createElement("br",null),r.createElement("br",null),r.createElement(f.Z,{variant:"contained",onClick:function(){O(!0),setTimeout((function(){O(!1)}),9e3)},sx:{display:"none"}},"Guide me through"))}),r.createElement(y.Z,{open:v,close:function(){return h(!1)},setGpx:n}),r.createElement(g.Z,{open:D,setOpen:I,name:"GPX Informations"},r.createElement(u.Z,{metadata:P})),r.createElement(l.Z,{setData:function(t){return n(t)}}),r.createElement(a.Z,{gpxData:e,onParseGpxData:function(t){return M(t.metadata?t.metadata:[])}}),r.createElement(o.Z,{geojson:c.geojson}))}.bind({});O.parameters={},O.parameters=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?v(Object(n),!0).forEach((function(e){h(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({storySource:{source:"() => {\n\tconst [gpxData, setGpxData] = useState<string | undefined>();\n\tconst parsedGpx = useGpx({ data: gpxData });\n\tconst [demoLoaderOpen, setDemoLoaderOpen] = useState(false);\n\tconst [guide, setGuide] = useState(false);\n\tconst [metadata, setMetadata] = useState<MetadataType[]>([]);\n\tconst mapHook = useMap({ mapId: 'map_1' });\n\tconst [openSidebar, setOpenSidebar] = useState(true);\n\n\tconst handleClick1 = () => {\n\t\tsetDemoLoaderOpen(!demoLoaderOpen);\n\t};\n\n\tconst handleClick2 = () => {\n\t\tsetGuide(true);\n\t\tsetTimeout(() => {\n\t\t\tsetGuide(false);\n\t\t}, 9000);\n\t};\n\tuseEffect(() => {\n\t\tif (!mapHook.map) return;\n\t\tif (mapHook.map.map.getPitch() != 60) {\n\t\t\tmapHook.map.map.setPitch(60);\n\t\t}\n\t}, [mapHook.map]);\n\n\treturn (\n\t\t<>\n\t\t\t<MlGpxViewerInstructions open={guide} />\n\t\t\t<TopToolbar\n\t\t\t\tbuttons={\n\t\t\t\t\t<>\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tvariant={openSidebar ? 'contained' : 'outlined'}\n\t\t\t\t\t\t\tonClick={() => setOpenSidebar(!openSidebar)}\n\t\t\t\t\t\t\tsx={{ marginRight: { xs: '0px', sm: '10px' } }}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\tInformations\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t<br />\n\t\t\t\t\t\t<br />\n\t\t\t\t\t\t<UploadButton\n\t\t\t\t\t\t\tsetData={setGpxData}\n\t\t\t\t\t\t\tbuttonComponent={\n\t\t\t\t\t\t\t\t<Button variant=\"contained\" sx={{ marginRight: { xs: '0px', sm: '10px' } }}>\n\t\t\t\t\t\t\t\t\tUpload\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<br />\n\t\t\t\t\t\t<br />\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tvariant=\"contained\"\n\t\t\t\t\t\t\tonClick={handleClick1}\n\t\t\t\t\t\t\tsx={{ marginRight: { xs: '0px', sm: '10px' } }}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\tDemo Mode\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t<br />\n\t\t\t\t\t\t<br />\n\t\t\t\t\t\t<Button variant=\"contained\" onClick={handleClick2} sx={{ display: 'none' }}>\n\t\t\t\t\t\t\tGuide me through\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</>\n\t\t\t\t}\n\t\t\t/>\n\t\t\t<MlGpxDemoLoader\n\t\t\t\topen={demoLoaderOpen}\n\t\t\t\tclose={() => setDemoLoaderOpen(false)}\n\t\t\t\tsetGpx={setGpxData}\n\t\t\t/>\n\n\t\t\t<Sidebar\n\t\t\t\topen={openSidebar}\n\t\t\t\tsetOpen={setOpenSidebar}\n\t\t\t\tname={'GPX Informations'}\n\t\t\t>\n\t\t\t\t<Metadata metadata={metadata} />\n\t\t\t</Sidebar>\n\t\t\t<Dropzone setData={(data) => setGpxData(data)} />\n\t\t\t<MlGpxViewer\n\t\t\t\tgpxData={gpxData}\n\t\t\t\tonParseGpxData={(parsedGpx) => setMetadata(parsedGpx.metadata ? parsedGpx.metadata : [])}\n\t\t\t/>\n\t\t\t<MlSpatialElevationProfile geojson={parsedGpx.geojson} />\n\t\t</>\n\t);\n}"}},O.parameters);var j=["ExampleConfig"]},6050:(t,e,n)=>{n.d(e,{Z:()=>d});var r=n(2784),o=n(20755),a=n(91004),i=n(5284),l=n(47415),s=n(12642);function u(t){return function(t){if(Array.isArray(t))return c(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return c(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?c(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var p=["interpolate",["linear"],["get","height"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"yellow"],m=function t(e){var n=(0,r.useRef)("elevationprofile-"+(0,a.Z)()),c=(0,r.useRef)("elevationprofile-layer-"+(0,a.Z)()),m=e.elevationFactor||t.defaultProps.elevationFactor,d=(0,r.useMemo)((function(){var t,n;if(null!=e&&null!==(t=e.geojson)&&void 0!==t&&t.features){var r=null===(n=e.geojson.features)||void 0===n?void 0:n.find((function(t){return"LineString"===t.geometry.type}));if(r&&r.geometry){var o=r.geometry.coordinates.map((function(t){return t[2]})),a=Math.min.apply(Math,u(o)),i=Math.max.apply(Math,u(o))-a;return{max:i=0===i?1:i,min:a,line:r}}}}),[e.geojson]),f=(0,r.useMemo)((function(){return d?["interpolate",["linear"],["get","height"],0,"rgb(0,255,55)",d.max*m,"rgb(255,0,0)"]:p}),[d,e.elevationFactor]),y=(0,r.useMemo)((function(){var t;if(null!==(t=e.geojson)&&void 0!==t&&t.features&&d){var n=function(t,e){var n=function(t,n,r,a,i){var l=(0,o.Tu)([[t,n],[a,i]]),u=(0,s.woY)(l,5,{units:"meters"}),c=u.geometry.coordinates[0][0],p=u.geometry.coordinates[0][1],m=u.geometry.coordinates[1][0],d=u.geometry.coordinates[1][1];return(0,o.yu)([[[t,n],[a,i],[m,d],[c,p],[t,n]]],{height:r*e})},r=function(t,e,n){return t*(1-n)+e*n},a=[];return t.line.geometry.coordinates.forEach((function(e,o){if(t.line.geometry.coordinates[o+1]){var i=~~(1e3*(0,s.TE$)([e[0],e[1]],[t.line.geometry.coordinates[o+1][0],t.line.geometry.coordinates[o+1][1]],{units:"kilometers"})/10);i=i<1?1:i;for(var l=0;l<i;l++){var u=r(t.line.geometry.coordinates[o][0],t.line.geometry.coordinates[o+1][0],l/i),c=r(t.line.geometry.coordinates[o][1],t.line.geometry.coordinates[o+1][1],l/i),p=r(t.line.geometry.coordinates[o][2]-t.min,t.line.geometry.coordinates[o+1][2]-t.min,l/i),m=r(t.line.geometry.coordinates[o][0],t.line.geometry.coordinates[o+1][0],(l+1)/i),d=r(t.line.geometry.coordinates[o][1],t.line.geometry.coordinates[o+1][1],(l+1)/i),f=n(u,c,p,m,d);a.push(f)}}})),(0,o.uf)(a)}(d,m);return n}}),[d,m]);return(0,i.Z)({mapId:e.mapId,sourceId:n.current,source:{type:"geojson",data:y||(0,o.uf)([])}}),(0,l.Z)({layerId:c.current,options:{source:n.current,type:"fill-extrusion",paint:{"fill-extrusion-height":["get","height"],"fill-extrusion-opacity":.9,"fill-extrusion-color":f||p}},insertBeforeLayer:e.insertBeforeLayer}),r.createElement(r.Fragment,null)};m.defaultProps={elevationFactor:1};const d=m;try{m.displayName="MlSpatialElevationProfile",m.__docgenInfo={description:"",displayName:"MlSpatialElevationProfile",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},geojson:{defaultValue:null,description:"GeoJSON data that is supposed to be rendered by this component.",name:"geojson",required:!0,type:{name:"FeatureCollection<Geometry | GeometryCollection, Properties> | geojson | undefined"}},idPrefix:{defaultValue:null,description:"Prefix of the component id this component uses when adding elements to the MapLibreGl-instance",name:"idPrefix",required:!1,type:{name:"string | undefined"}},elevationFactor:{defaultValue:{value:"1"},description:"Number describes the factor of the height of the elevation",name:"elevationFactor",required:!1,type:{name:"number | undefined"}},insertBeforeLayer:{defaultValue:null,description:'The layerId of an existing layer this layer should be rendered visually beneath\nhttps://maplibre.org/maplibre-gl-js-docs/api/map/#map#addlayer - see "beforeId" property',name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MlSpatialElevationProfile/MlSpatialElevationProfile.tsx#MlSpatialElevationProfile"]={docgenInfo:m.__docgenInfo,name:"MlSpatialElevationProfile",path:"src/components/MlSpatialElevationProfile/MlSpatialElevationProfile.tsx#MlSpatialElevationProfile"})}catch(t){}}}]);